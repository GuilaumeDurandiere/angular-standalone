<div class="container-lg" *ngIf="workflow$ | async as workflow">
    <div class="row">
        <div class="p-3">
            <h1 class="title">
                {{ workflow.libelle }}
            </h1>
        </div>
    </div>
    <div class="row justify-content-between">
        <div class="col-lg-8 p-3">
            <h2 i18n="@@STEPS" class="subtitle">
                Étape(s)
            </h2>
        </div>
        <div class="col-lg-4 p-3 text-end">
            <button
                pButton
                pRipple
                i18n-label="@@ADD_STEP"
                label="Ajouter une étape"
                icon="pi pi-plus-circle"
                class="add-step-button"
                (click)="showAddStepModal(workflow.libelle)"
            ></button>
        </div>
    </div>
    <p-messages severity="info" class="infoContainer">
        <ng-template pTemplate>
            <span class="pi pi-info-circle infoIcon"></span>
            <div i18n="@@SUBSTEP_CREATION_INFO" class="infoMessage">Pour créer une sous-étape, cliquez sur une étape.</div>
        </ng-template>
    </p-messages>
    <!-- [lazy]="true"
        (onLazyLoad)="getAll($event)"
        (onRowSelect)="onRowSelect($event)"
    -->
    <p-table
        [value]="workflow.etapes"
        [tableStyle]="{ 'min-width': '50rem' }"
        [paginator]="true"
        [rows]="15"
        [showCurrentPageReport]="false"
        paginatorLocale="fr-FR"
        selectionMode="single"
    >
        <ng-template pTemplate="header">
            <tr>
                <th i18n="@@NAME" style="width: 20%">Nom</th>
                <th i18n="@@DESCRIPTION">Description</th>
                <th i18n="@@STEP_STATUS">Statut de l'étape</th>
                <th i18n="@@ACTIONS" style="width: 12%">Actions</th>
            </tr>
        </ng-template>
        <ng-template pTemplate="body" let-etape>
            <tr
                [pSelectableRow]="etape"
                (click)="selectRow(workflow.id, etape.id)"
            >
                <td>{{ etape.libelle }}</td>
                <td>{{ etape.description }}</td>
                <td>{{ etape.statut }}</td>
                <td>
                    <span class="p-buttonset">
                        <p-button
                        icon="pi pi-pencil"
                        [text]="true"
                        class="action-icon modify-copy-icon"
                        (click)="showUpdateStepModal(etape)"
                        ></p-button>
                        <p-button
                        icon="pi pi-trash"
                        [text]="true"
                        class="action-icon delete-icon"
                        (click)="deleteConfirmation(workflow.etapes, etape)"
                        ></p-button>
                    </span>
                </td>
            </tr>
        </ng-template>
    </p-table>
    <button
        pButton
        pRipple
        i18n-label="@@BACK_TO_WORKFLOW_TABLE"
        label="Retourner au tableau des workflow"
        icon="pi pi-arrow-circle-left"
        class="generic-button"
        [routerLink]="['/administration', 'workflow']"
    ></button>
    <p-confirmDialog></p-confirmDialog>
</div>
